{"version":3,"sources":["../../routes/voice-mail.js"],"names":["express","require","router","Router","fs","path","url","valueEncoding","level","get","req","res","next","links","createReadStream","keys","values","on","data","value","JSON","parse","push","key","image","audio_path","waveForm","err","render","title","images","post","status","json","success","loadVoiceMessages","module","exports"],"mappings":"AAAA;;AACA,IAAIA,UAAUC,QAAQ,SAAR,CAAd;AACA,IAAIC,SAASF,QAAQG,MAAR,EAAb;AACA,IAAMC,KAAKH,QAAQ,IAAR,CAAX;AACA,IAAMI,OAAOJ,QAAQ,MAAR,CAAb;AACA,IAAMK,MAAML,QAAQ,KAAR,CAAZ;;eACgBA,QAAQ,UAAR,EAAoB,IAApB,EAA0B,EAACM,eAAe,MAAhB,EAA1B,C;IAATC,K,YAAAA,K;;AAEPN,OAAOO,GAAP,CAAW,GAAX,EAAgB,UAAUC,GAAV,EAAeC,GAAf,EAAoBC,IAApB,EAA0B;AACxC,MAAIC,QAAQ,EAAZ;AACAL,QAAMM,gBAAN,CAAuB,EAACC,MAAM,IAAP,EAAaC,QAAQ,IAArB,EAAvB,EACCC,EADD,CACI,MADJ,EACY,UAAUC,IAAV,EAAgB;AAC1B;AACA,QAAIC,QAAQC,KAAKC,KAAL,CAAWH,KAAKC,KAAhB,CAAZ;AACAN,UAAMS,IAAN,CAAW,EAACC,KAAKL,KAAKK,GAAX,EAAgBC,OAAOL,MAAMK,KAA7B,EAAoCC,YAAYN,MAAMM,UAAtD,EAAkEC,UAAUP,MAAMO,QAAlF,EAAX;AACD,GALD,EAKGT,EALH,CAKM,KALN,EAKa,UAACU,GAAD,EAAS;AACpB;AACA;AACAhB,QAAIiB,MAAJ,CAAW,YAAX,EAAyB,EAACC,OAAO,SAAR,EAAmBC,QAAQjB,KAA3B,EAAzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACD,GAnBD;;AAqBA;AACD,CAxBD;;AA0BAX,OAAO6B,IAAP,CAAY,aAAZ,EAA2B,UAACrB,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAoB;;AAE7CD,MAAIqB,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,EAACC,SAAS,IAAV,EAArB;AACD,CAHD;;AAKA,SAASC,iBAAT,GAA8B,CAE7B;;AAEDC,OAAOC,OAAP,GAAiBnC,MAAjB","file":"voice-mail.js","sourcesContent":["'use strict'\nvar express = require('express')\nvar router = express.Router()\nconst fs = require('fs')\nconst path = require('path')\nconst url = require('url')\nconst {level} = require('../level')('vm', {valueEncoding: 'json'})\n\nrouter.get('/', function (req, res, next) {\n  let links = []\n  level.createReadStream({keys: true, values: true})\n  .on('data', function (data) {\n    // console.log('value=', data)\n    let value = JSON.parse(data.value)\n    links.push({key: data.key, image: value.image, audio_path: value.audio_path, waveForm: value.waveForm})\n  }).on('end', (err) => {\n    // console.log(links)\n    // let links = fd.map((x) => {return `/uploads/${x}`})\n    res.render('voice-mail', {title: 'Express', images: links})\n    // fs.readdir('./uploads/ig', (error, fd) => {\n    //\n    //   if (!fd) {\n    //     return res.render('voice-mail', {title: 'Express', images: []})\n    //   }\n    //   // let links = fd.filter((x) => { if (/\\.wav/.test()) return x }).map((x) => {return `/uploads/${x}`})\n    //   let links = fd.filter(function (s) {if (/\\.jpg/.test(s))return s }).map((x) => {return `/uploads/ig/${x}`})\n    //   // let links = fd.filter(function (s)  {if (/\\.wav/.test(s))return s }).map((x) => {return `/uploads/${x}`})\n    //\n    // })\n  })\n\n  // res.render('voice-mail', {title: 'Express'})\n})\n\nrouter.post('/delete/:id', (req, res, next) => {\n\n  res.status(200).json({success: true})\n})\n\nfunction loadVoiceMessages () {\n\n}\n\nmodule.exports = router\n"]}