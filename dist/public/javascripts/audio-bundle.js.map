{"version":3,"sources":["../../../public/javascripts/audio-bundle.js"],"names":["context","window","AudioContext","webkitAudioContext","createGain","createGainNode","createDelay","createDelayNode","createScriptProcessor","createJavaScriptNode","requestAnimFrame","requestAnimationFrame","webkitRequestAnimationFrame","mozRequestAnimationFrame","oRequestAnimationFrame","msRequestAnimationFrame","callback","setTimeout","playSound","buffer","time","source","createBufferSource","connect","destination","start","loadSounds","obj","soundMap","names","paths","name","path","push","bufferLoader","BufferLoader","bufferList","i","length","load","urlList","onload","Array","loadCount","prototype","loadBuffer","url","index","request","XMLHttpRequest","open","responseType","loader","decodeAudioData","response","alert","error","console","onerror","send","WIDTH","HEIGHT","SMOOTHING","FFT_SIZE","VisualizerSample","cb","analyser","createAnalyser","minDecibels","maxDecibels","onLoaded","freqs","Uint8Array","frequencyBinCount","times","$","text","prop","isPlaying","startTime","startOffset","togglePlayback","play","stop","currentTime","log","loop","duration","onended","draw","bind","e","disconnect","click","sample","smoothingTimeConstant","fftSize","getByteFrequencyData","getByteTimeDomainData","width","Math","floor","canvas","document","querySelector","drawContext","getContext","height","value","percent","offset","barWidth","hue","fillStyle","fillRect","getFrequencyValue","freq","nyquist","sampleRate","round","cameraPreview","getElementById","socketio","io","mediaStream","on","startRecording","disabled","stopRecording","progressBar","percentage","recordAudio","recordVideo","onclick","navigator","getUserMedia","audio","stream","RecordRTC","type","recorderType","StereoAudioRecorder","onAudioProcessStarted","src","URL","createObjectURL","muted","controls","videoOnlyStream","MediaStream","getVideoTracks","forEach","track","addTrack","mozGetUserMedia","MediaStreamRecorder","WhammyRecorder","JSON","stringify","getDataURL","audioDataURL","videoDataURL","files","getBlob","dataURL","video","emit","poster","trigger","fileName","href","location","split","pop","replace","result","parseInt","parentNode","style","display","innerHTML"],"mappings":"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","file":"audio-bundle.js","sourcesContent":["// Start off by initializing a new context.\nvar context = new (window.AudioContext || window.webkitAudioContext)()\n\nif (!context.createGain)\n  context.createGain = context.createGainNode\nif (!context.createDelay)\n  context.createDelay = context.createDelayNode\nif (!context.createScriptProcessor)\n  context.createScriptProcessor = context.createJavaScriptNode\n\n// shim layer with setTimeout fallback\nwindow.requestAnimFrame = (function () {\n  return window.requestAnimationFrame ||\n    window.webkitRequestAnimationFrame ||\n    window.mozRequestAnimationFrame ||\n    window.oRequestAnimationFrame ||\n    window.msRequestAnimationFrame ||\n    function (callback) {\n      window.setTimeout(callback, 1000 / 60)\n    }\n})()\n\nfunction playSound (buffer, time) {\n  var source = context.createBufferSource()\n  source.buffer = buffer\n  source.connect(context.destination)\n  source[source.start ? 'start' : 'noteOn'](time)\n}\n\nfunction loadSounds (obj, soundMap, callback) {\n  // Array-ify\n  var names = []\n  var paths = []\n  for (var name in soundMap) {\n    var path = soundMap[name]\n    names.push(name)\n    paths.push(path)\n  }\n  bufferLoader = new BufferLoader(context, paths, function (bufferList) {\n    for (var i = 0; i < bufferList.length; i++) {\n      var buffer = bufferList[i]\n      var name = names[i]\n      obj[name] = buffer\n    }\n    if (callback) {\n      callback()\n    }\n  })\n  bufferLoader.load()\n}\n\nfunction BufferLoader (context, urlList, callback) {\n  this.context = context\n  this.urlList = urlList\n  this.onload = callback\n  this.bufferList = new Array()\n  this.loadCount = 0\n}\n\nBufferLoader.prototype.loadBuffer = function (url, index) {\n  // Load buffer asynchronously\n  var request = new XMLHttpRequest()\n  request.open('GET', url, true)\n  request.responseType = 'arraybuffer'\n\n  var loader = this\n\n  request.onload = function () {\n    // Asynchronously decode the audio file data in request.response\n    loader.context.decodeAudioData(\n      request.response,\n      function (buffer) {\n        if (!buffer) {\n          alert('error decoding file data: ' + url)\n          return\n        }\n        loader.bufferList[index] = buffer\n        if (++loader.loadCount == loader.urlList.length)\n          loader.onload(loader.bufferList)\n      },\n      function (error) {\n        console.error('decodeAudioData error', error)\n      }\n    )\n  }\n\n  request.onerror = function () {\n    alert('BufferLoader: XHR error')\n  }\n\n  request.send()\n}\n\nBufferLoader.prototype.load = function () {\n  for (var i = 0; i < this.urlList.length; ++i)\n    this.loadBuffer(this.urlList[i], i);\n}\n\n/*\n * Copyright 2013 Boris Smus. All Rights Reserved.\n\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nvar WIDTH = 640\nvar HEIGHT = 360\n\n// Interesting parameters to tweak!\nvar SMOOTHING = 0.8\nvar FFT_SIZE = 2048\n\nfunction VisualizerSample (url, cb) {\n  this.analyser = context.createAnalyser()\n\n  this.analyser.connect(context.destination)\n  this.analyser.minDecibels = -140\n  this.analyser.maxDecibels = 0\n  loadSounds(this, {\n    buffer: url\n  }, onLoaded)\n  this.freqs = new Uint8Array(this.analyser.frequencyBinCount)\n  this.times = new Uint8Array(this.analyser.frequencyBinCount)\n\n  function onLoaded () {\n    // var button = document.querySelector('button')\n    // button.removeAttribute('disabled')\n    $('#playback-click').text('Play/pause')\n    $('#playback-click').prop('disabled', false)\n\n    return cb()\n  }\n\n  this.isPlaying = false\n  this.startTime = 0\n  this.startOffset = 0\n}\n\n// Toggle playback\nVisualizerSample.prototype.togglePlayback = function () {\n  \n    this.play()\n  \n}\n\nVisualizerSample.prototype.play = function () {\n   $('#rerecord').prop('disabled', true)\n     this.stop()\n\n  this.startTime = context.currentTime\n  console.log('started at', this.startOffset)\n  this.source = context.createBufferSource()\n  // Connect graph\n  this.source.connect(this.analyser)\n  this.source.buffer = this.buffer\n  this.source.loop = false\n  // Start playback, but make sure we stay in bound of the buffer.\n  this.source[this.source.start ? 'start' : 'noteOn'](0, this.startOffset % this.buffer.duration)\n  // Start visualizer.\n  this.isPlaying = true\n\n  this.source.onended = this.onended\n  requestAnimFrame(this.draw.bind(this))\n}\n\nVisualizerSample.prototype.stop = function () {\n//   if (this.isPlaying) {\ntry{\nthis.source[this.source.stop ? 'stop' : 'noteOff'](0)\n    this.startOffset += context.currentTime - this.startTime\n    console.log('paused at', this.startOffset)\n}catch(e){\n  \n}\n    \n//   }\n  this.startOffset = 0\n  this.isPlaying = false\n\n}\n\nVisualizerSample.prototype.disconnect = function () {\n  this.stop()\n  this.source.disconnect(0)\n  this.startOffset = 0\n}\n\nVisualizerSample.prototype.onended = function () {\n    this.stop()\n   $('#rerecord').prop('disabled', false)\n  \n}\n\n$('#playback-click').click(function () {\n  sample.togglePlayback()\n})\n\nVisualizerSample.prototype.draw = function () {\n  this.analyser.smoothingTimeConstant = SMOOTHING\n  this.analyser.fftSize = FFT_SIZE\n\n  // Get the frequency data from the currently playing music\n  this.analyser.getByteFrequencyData(this.freqs)\n  this.analyser.getByteTimeDomainData(this.times)\n\n  var width = Math.floor(1 / this.freqs.length, 10)\n\n  var canvas = document.querySelector('canvas')\n  var drawContext = canvas.getContext('2d')\n  canvas.width = WIDTH\n  canvas.height = HEIGHT\n  // Draw the frequency domain chart.\n  for (var i = 0; i < this.analyser.frequencyBinCount; i++) {\n    var value = this.freqs[i]\n    var percent = value / 256\n    var height = HEIGHT * percent\n    var offset = HEIGHT - height - 1\n    var barWidth = WIDTH / this.analyser.frequencyBinCount\n    var hue = i / this.analyser.frequencyBinCount * 360\n    drawContext.fillStyle = 'hsl(' + hue + ', 100%, 50%)'\n    drawContext.fillRect(i * barWidth, offset, barWidth, height)\n  }\n\n  // Draw the time domain chart.\n  for (var i = 0; i < this.analyser.frequencyBinCount; i++) {\n    var value = this.times[i]\n    var percent = value / 256\n    var height = HEIGHT * percent\n    var offset = HEIGHT - height - 1\n    var barWidth = WIDTH / this.analyser.frequencyBinCount\n    drawContext.fillStyle = 'white'\n    drawContext.fillRect(i * barWidth, offset, 1, 2)\n  }\n\n  if (this.isPlaying) {\n    requestAnimFrame(this.draw.bind(this))\n  }\n}\n\nVisualizerSample.prototype.getFrequencyValue = function (freq) {\n  var nyquist = context.sampleRate / 2\n  var index = Math.round(freq / nyquist * this.freqs.length)\n  return this.freqs[index]\n}\n\nvar sample\n// document.querySelector('button').addEventListener('click', function () {\n//   sample.togglePlayback()\n// })\n\nvar cameraPreview = document.getElementById('camera-preview')\nif (false /* for Microsoft Edge */) {\n//            cameraPreview.parentNode.innerHTML = '<audio id=\"camera-preview\" controls style=\"border: 1px solid rgb(15, 158, 238); width: 94%;\"></audio> '\n}\nvar socketio = io()\nvar mediaStream = null\nsocketio.on('connect', function () {\n  startRecording.disabled = false\n})\nvar startRecording = document.getElementById('start-recording')\nvar stopRecording = document.getElementById('stop-recording')\nvar cameraPreview = document.getElementById('camera-preview')\nvar progressBar = document.querySelector('#progress-bar')\nvar percentage = document.querySelector('#percentage')\nvar recordAudio, recordVideo\n\nstartRecording.onclick = function () {\n  startRecording.disabled = true\n  if (sample)\n    sample.disconnect()\n  navigator.getUserMedia({\n    audio: true,\n//                video: true\n  }, function (stream) {\n    mediaStream = stream\n    recordAudio = RecordRTC(stream, {\n      type: 'audio',\n      recorderType: StereoAudioRecorder,\n      onAudioProcessStarted: function () {\n        recordVideo.startRecording()\n        cameraPreview.src = window.URL.createObjectURL(stream)\n        cameraPreview.play()\n        cameraPreview.muted = true\n        cameraPreview.controls = false\n//                        cameraPreview.context\n      }\n    })\n    var videoOnlyStream = new MediaStream()\n    stream.getVideoTracks().forEach(function (track) {\n      videoOnlyStream.addTrack(track)\n    })\n    recordVideo = RecordRTC(videoOnlyStream, {\n      type: 'video',\n      recorderType: !!navigator.mozGetUserMedia ? MediaStreamRecorder : WhammyRecorder\n    })\n    recordAudio.startRecording()\n\n    stopRecording.disabled = false\n  }, function (error) {\n    alert(JSON.stringify(error))\n  })\n}\nstopRecording.onclick = function () {\n  startRecording.disabled = false\n  stopRecording.disabled = true\n  // stop audio recorder\n  recordAudio.stopRecording(function () {\n    // stop video recorder\n    recordVideo.stopRecording(function () {\n      // get audio data-URL\n      recordAudio.getDataURL(function (audioDataURL) {\n        // get video data-URL\n        recordVideo.getDataURL(function (videoDataURL) {\n          var files = {\n            audio: {\n              type: recordAudio.getBlob().type || 'audio/wav',\n              dataURL: audioDataURL\n            },\n            video: {\n              type: recordVideo.getBlob().type || 'video/webm',\n              dataURL: videoDataURL\n            }\n          }\n          socketio.emit('message', files)\n          if (mediaStream) mediaStream.stop()\n        })\n      })\n      cameraPreview.src = ''\n      cameraPreview.poster = 'ajax-loader.gif'\n    })\n  })\n  // if firefox or if you want to record only audio\n  // stop audio recorder\n  recordAudio.stopRecording(function () {\n    // get audio data-URL\n    recordAudio.getDataURL(function (audioDataURL) {\n      var files = {\n        audio: {\n          type: recordAudio.getBlob().type || 'audio/wav',\n          dataURL: audioDataURL\n        }\n      }\n      socketio.emit('message', files)\n      if (mediaStream) mediaStream.stop()\n    })\n    cameraPreview.src = ''\n    cameraPreview.poster = 'ajax-loader.gif'\n  })\n}\n\n$('#rerecord').click(function () {\n  $('#start-recording').trigger('click')\n})\nsocketio.on('merged', function (fileName) {\n  var href = (location.href.split('/').pop().length ? location.href.replace(location.href.split('/').pop(), '') : location.href)\n  href = href + 'uploads/' + fileName\n  console.log('got file ' + href)\n  sample = new VisualizerSample(href, function () {\n  \n    sample.togglePlayback()\n\n//test\n//     cameraPreview.src = href\n//     cameraPreview.play()\n//     cameraPreview.muted = false\n//     cameraPreview.controls = true\n  })\n\n})\nsocketio.on('ffmpeg-output', function (result) {\n  if (parseInt(result) >= 100) {\n    progressBar.parentNode.style.display = 'none'\n    return\n  }\n  progressBar.parentNode.style.display = 'block'\n  progressBar.value = result\n  percentage.innerHTML = 'Ffmpeg Progress ' + result + '%'\n})\nsocketio.on('ffmpeg-error', function (error) {\n  alert(error)\n})"]}