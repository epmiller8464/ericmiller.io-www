{"version":3,"sources":["../../../public/javascripts/audio-bundle.js"],"names":["context","window","AudioContext","webkitAudioContext","createGain","createGainNode","createDelay","createDelayNode","createScriptProcessor","createJavaScriptNode","requestAnimFrame","requestAnimationFrame","webkitRequestAnimationFrame","mozRequestAnimationFrame","oRequestAnimationFrame","msRequestAnimationFrame","callback","setTimeout","bytesToSize","bytes","k","sizes","i","parseInt","Math","floor","log","pow","toPrecision","playSound","buffer","time","source","createBufferSource","connect","destination","start","loadSounds","obj","soundMap","names","paths","name","path","push","bufferLoader","BufferLoader","bufferList","length","load","urlList","onload","Array","loadCount","prototype","loadBuffer","url","index","request","XMLHttpRequest","open","responseType","loader","decodeAudioData","response","alert","error","console","onerror","send","WIDTH","HEIGHT","SMOOTHING","FFT_SIZE","configureAudioAPI","config","cb","api","type","WebVoiceMail","sample","VisualizerSample","href","togglePlayback","mediaStream","input","createMediaStreamSource","filter","createBiquadFilter","frequency","value","Q","analyser","createAnalyser","draw","freqs","Uint8Array","frequencyBinCount","times","sampleBuffer","isLive","startTime","startOffset","maxTime","canvas","play","currentTime","loop","duration","onEnded","bind","stop","disconnect","e","smoothingTimeConstant","fftSize","getByteFrequencyData","getByteTimeDomainData","width","drawContext","getContext","height","percent","offset","barWidth","hue","fillStyle","fillRect","getFrequencyValue","freq","nyquist","sampleRate","round","onError","onStreamError","minDecibels","maxDecibels","onLoaded","$","text","prop","isPlaying","cameraPreview","document","getElementById","socketio","io","on","startRecording","disabled","stopRecording","progressBar","querySelector","percentage","recordAudio","recordVideo","liveSample","onclick","navigator","getUserMedia","audio","stream","RecordRTC","recorderType","StereoAudioRecorder","onAudioProcessStarted","src","URL","createObjectURL","muted","controls","JSON","stringify","getDataURL","audioDataURL","files","getBlob","dataURL","emit","poster","click","fileName","location","split","pop","replace","result","parentNode","style","display","innerHTML"],"mappings":"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","file":"audio-bundle.js","sourcesContent":["// Start off by initializing a new context.\ncontext = new (window.AudioContext || window.webkitAudioContext)()\n\nif (!context.createGain) { context.createGain = context.createGainNode }\nif (!context.createDelay) { context.createDelay = context.createDelayNode }\nif (!context.createScriptProcessor) { context.createScriptProcessor = context.createJavaScriptNode }\n\n// shim layer with setTimeout fallback\nwindow.requestAnimFrame = (function () {\n  return window.requestAnimationFrame ||\n    window.webkitRequestAnimationFrame ||\n    window.mozRequestAnimationFrame ||\n    window.oRequestAnimationFrame ||\n    window.msRequestAnimationFrame ||\n    function (callback) {\n      window.setTimeout(callback, 1000 / 60)\n    }\n})()\n\nfunction bytesToSize (bytes) {\n  var k = 1000\n  var sizes = ['Bytes', 'KB', 'MB', 'GB', 'TB']\n  if (bytes === 0) {\n    return '0 Bytes'\n  }\n  var i = parseInt(Math.floor(Math.log(bytes) / Math.log(k)), 10)\n  return (bytes / Math.pow(k, i)).toPrecision(3) + ' ' + sizes[i]\n}\n\nfunction playSound (buffer, time) {\n  var source = context.createBufferSource()\n  source.buffer = buffer\n  source.connect(context.destination)\n  source[source.start ? 'start' : 'noteOn'](time)\n}\n\nfunction loadSounds (obj, soundMap, callback) {\n  // Array-ify\n  var names = []\n  var paths = []\n  for (var name in soundMap) {\n    var path = soundMap[name]\n    names.push(name)\n    paths.push(path)\n  }\n  bufferLoader = new BufferLoader(context, paths, function (bufferList) {\n    for (var i = 0; i < bufferList.length; i++) {\n      var buffer = bufferList[i]\n      var name = names[i]\n      obj[name] = buffer\n    }\n    if (callback) {\n      callback()\n    }\n  })\n  bufferLoader.load()\n}\n\nfunction BufferLoader (context, urlList, callback) {\n  this.context = context\n  this.urlList = urlList\n  this.onload = callback\n  this.bufferList = new Array()\n  this.loadCount = 0\n}\n\nBufferLoader.prototype.loadBuffer = function (url, index) {\n  // Load buffer asynchronously\n  var request = new XMLHttpRequest()\n  request.open('GET', url, true)\n  request.responseType = 'arraybuffer'\n\n  var loader = this\n\n  request.onload = function () {\n    // Asynchronously decode the audio file data in request.response\n    loader.context.decodeAudioData(\n      request.response,\n      function (buffer) {\n        if (!buffer) {\n          alert('error decoding file data: ' + url)\n          return\n        }\n        loader.bufferList[index] = buffer\n        if (++loader.loadCount == loader.urlList.length) { loader.onload(loader.bufferList) }\n      },\n      function (error) {\n        console.error('decodeAudioData error', error)\n      }\n    )\n  }\n\n  request.onerror = function () {\n    alert('BufferLoader: XHR error')\n  }\n\n  request.send()\n}\n\nBufferLoader.prototype.load = function () {\n  for (var i = 0; i < this.urlList.length; ++i) { this.loadBuffer(this.urlList[i], i) }\n}\n\n/*\n * Copyright 2013 Boris Smus. All Rights Reserved.\n\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nvar WIDTH = 640\nvar HEIGHT = 360\n\n// Interesting parameters to tweak!\nvar SMOOTHING = 0.4\nvar FFT_SIZE = 2048 << 0x01\n\nfunction configureAudioAPI (config, cb) {\n  var api = null\n  switch (config.type) {\n    case 'live-audio':\n      api = WebVoiceMail(config, cb)\n      break\n    case 'playback-audio':\n      sample = new VisualizerSample(href, function () {\n        sample.togglePlayback()\n// tes\n//     cameraPreview.src = href\n//     cameraPreview.play()\n//     cameraPreview.muted = false\n//     cameraPreview.controls = true\n      })\n      break\n  }\n}\n\nfunction WebVoiceMail (config, cb) {\n\n  this.mediaStream = config.source\n  this.input = context.createMediaStreamSource(this.mediaStream)\n  // Connect the input to a filter.\n  this.filter = context.createBiquadFilter()\n  this.filter.frequency.value = 60.0\n  this.filter.type = 'notch'\n  this.filter.Q = 10.0\n\n  this.analyser = context.createAnalyser()\n  // Connect graph.\n  this.input.connect(this.filter)\n  this.filter.connect(this.analyser)\n\n  this.draw()\n\n  this.freqs = new Uint8Array(this.analyser.frequencyBinCount)\n  this.times = new Uint8Array(this.analyser.frequencyBinCount)\n  this.sampleBuffer = new Uint8Array(this.analyser.frequencyBinCount)\n  this.isLive = false\n  this.startTime = 0\n  this.startOffset = 0\n  this.maxTime = 45000\n  this.canvas = config.canvas\n}\n\n// Toggle playback\nWebVoiceMail.prototype.togglePlayback = function () {\n  this.play()\n}\n\nWebVoiceMail.prototype.play = function () {\n  // $('#rerecord').prop('disabled', true)\n  // this.stop()\n\n  this.startTime = context.currentTime\n  console.log('started at', this.startOffset)\n  this.source = context.createBufferSource()\n  // Connect graph\n  this.source.connect(this.analyser)\n  this.source.buffer = this.buffer\n  this.source.loop = false\n  // Start playback, but make sure we stay in bound of the buffer.\n  this.source[this.source.start ? 'start' : 'noteOn'](0, this.startOffset % this.buffer.duration)\n  // Start visualizer.\n  this.isLive = true\n\n  this.source.onEnded = this.onEnded\n  requestAnimationFrame(this.draw.bind(this))\n}\n\nWebVoiceMail.prototype.stop = function () {\n//   if (this.isLive) {\n  try {\n    // this.source[this.source.stop ? 'stop' : 'noteOff'](0)\n    this.source.disconnect(0)\n    this.mediaStream.stop()\n    // this.startOffset = 0// += context.currentTime - this.startTime\n    console.log('stopped at', context.currentTime)\n  } catch (e) {\n  }\n\n  this.startOffset = 0\n  this.isLive = false\n}\n\nWebVoiceMail.prototype.disconnect = function () {\n  this.stop()\n  this.source.disconnect(0)\n  this.startOffset = 0\n}\n\nWebVoiceMail.prototype.onEnded = function () {\n  // this.stop()\n  // $('#rerecord').prop('disabled', false)\n  console.log('the stream ended do something')\n}\n\nWebVoiceMail.prototype.draw = function () {\n  this.analyser.smoothingTimeConstant = SMOOTHING\n  this.analyser.fftSize = FFT_SIZE\n\n  // Get the frequency data from the currently live stream\n  this.analyser.getByteFrequencyData(this.freqs)\n  this.analyser.getByteTimeDomainData(this.times)\n\n  var width = Math.floor(1 / this.freqs.length, 10)\n\n  // var canvas = document.querySelector('canvas')\n  var drawContext = this.canvas.getContext('2d')\n  this.canvas.width = WIDTH\n  this.canvas.height = HEIGHT\n  // Draw the frequency domain chart.\n  for (var i = 0; i < this.analyser.frequencyBinCount; i++) {\n    var value = this.freqs[i]\n    var percent = value / 256\n    var height = HEIGHT * percent\n    var offset = HEIGHT - height - 1\n    var barWidth = WIDTH / this.analyser.frequencyBinCount\n    var hue = i / this.analyser.frequencyBinCount * 360\n    drawContext.fillStyle = 'hsl(' + hue + ', 100%, 50%)'\n    drawContext.fillRect(i * barWidth, offset, barWidth, height)\n  }\n\n  // Draw the time domain chart.\n  for (var i = 0; i < this.analyser.frequencyBinCount; i++) {\n    var value = this.times[i]\n    var percent = value / 256\n    var height = HEIGHT * percent\n    var offset = HEIGHT - height - 1\n    var barWidth = WIDTH / this.analyser.frequencyBinCount\n    drawContext.fillStyle = 'white'\n    drawContext.fillRect(i * barWidth, offset, 1, 2)\n  }\n\n  if (this.isLive) {\n    requestAnimationFrame(this.draw.bind(this))\n  }\n}\n\nWebVoiceMail.prototype.getFrequencyValue = function (freq) {\n  var nyquist = context.sampleRate / 2\n  var index = Math.round(freq / nyquist * this.freqs.length)\n  return this.freqs[index]\n}\n\nWebVoiceMail.prototype.sample = function (freq) {\n  var sampleRate = context.sampleRate\n  var index = Math.round(freq / sampleRate * this.freqs.length)\n  return this.freqs[index]\n}\n\nWebVoiceMail.prototype.onError = function onStreamError (e) {\n  console.error(e)\n}\n\nfunction VisualizerSample (config, cb) {\n  this.analyser = context.createAnalyser()\n\n  this.analyser.connect(context.destination)\n  this.analyser.minDecibels = config.minDecibels || -140\n  this.analyser.maxDecibels = config.maxDecibels || 0\n  loadSounds(this, {\n    buffer: config.source\n  }, onLoaded)\n  this.freqs = new Uint8Array(this.analyser.frequencyBinCount)\n  this.times = new Uint8Array(this.analyser.frequencyBinCount)\n\n  function onLoaded () {\n    // var button = document.querySelector('button')\n    // button.removeAttribute('disabled')\n    $('#playback-click').text('Play/pause')\n    $('#playback-click').prop('disabled', false)\n\n    return cb()\n  }\n\n  this.isPlaying = false\n  this.startTime = 0\n  this.startOffset = 0\n  this.canvas = config.canvas\n}\n\n// Toggle playback\nVisualizerSample.prototype.togglePlayback = function () {\n  this.play()\n}\n\nVisualizerSample.prototype.play = function () {\n  $('#rerecord').prop('disabled', true)\n  this.stop()\n\n  this.startTime = context.currentTime\n  console.log('started at', this.startOffset)\n  this.source = context.createBufferSource()\n  // Connect graph\n  this.source.connect(this.analyser)\n  this.source.buffer = this.buffer\n  this.source.loop = false\n  // Start playback, but make sure we stay in bound of the buffer.\n  this.source[this.source.start ? 'start' : 'noteOn'](0, this.startOffset % this.buffer.duration)\n  // Start visualizer.\n  this.isPlaying = true\n\n  this.source.onEnded = this.onEnded\n  requestAnimFrame(this.draw.bind(this))\n}\n\nVisualizerSample.prototype.stop = function () {\n//   if (this.isPlaying) {\n  try {\n    this.source[this.source.stop ? 'stop' : 'noteOff'](0)\n    this.startOffset += context.currentTime - this.startTime\n    console.log('paused at', this.startOffset)\n  } catch (e) {\n\n  }\n\n//   }\n  this.startOffset = 0\n  this.isPlaying = false\n}\n\nVisualizerSample.prototype.disconnect = function () {\n  this.stop()\n  this.source.disconnect(0)\n  this.startOffset = 0\n}\n\nVisualizerSample.prototype.onEnded = function () {\n  this.stop()\n  $('#rerecord').prop('disabled', false)\n}\n\nVisualizerSample.prototype.draw = function () {\n  this.analyser.smoothingTimeConstant = SMOOTHING\n  this.analyser.fftSize = FFT_SIZE\n\n  // Get the frequency data from the currently playing music\n  this.analyser.getByteFrequencyData(this.freqs)\n  this.analyser.getByteTimeDomainData(this.times)\n\n  var width = Math.floor(1 / this.freqs.length, 10)\n\n  var drawContext = this.canvas.getContext('2d')\n  this.canvas.width = WIDTH\n  this.canvas.height = HEIGHT\n  // Draw the frequency domain chart.\n  for (var i = 0; i < this.analyser.frequencyBinCount; i++) {\n    var value = this.freqs[i]\n    var percent = value / 256\n    var height = HEIGHT * percent\n    var offset = HEIGHT - height - 1\n    var barWidth = WIDTH / this.analyser.frequencyBinCount\n    var hue = i / this.analyser.frequencyBinCount * 360\n    drawContext.fillStyle = 'hsl(' + hue + ', 100%, 50%)'\n    drawContext.fillRect(i * barWidth, offset, barWidth, height)\n  }\n\n  // Draw the time domain chart.\n  for (var i = 0; i < this.analyser.frequencyBinCount; i++) {\n    var value = this.times[i]\n    var percent = value / 256\n    var height = HEIGHT * percent\n    var offset = HEIGHT - height - 1\n    var barWidth = WIDTH / this.analyser.frequencyBinCount\n    drawContext.fillStyle = 'white'\n    drawContext.fillRect(i * barWidth, offset, 1, 2)\n  }\n\n  if (this.isPlaying) {\n    requestAnimationFrame(this.draw.bind(this))\n  }\n}\n\nVisualizerSample.prototype.getFrequencyValue = function (freq) {\n  var nyquist = context.sampleRate / 2\n  var index = Math.round(freq / nyquist * this.freqs.length)\n  return this.freqs[index]\n}\n\nvar cameraPreview = document.getElementById('camera-preview')\n\nif (false /* for Microsoft Edge */) {\n//            cameraPreview.parentNode.innerHTML = '<audio id=\"camera-preview\" controls style=\"border: 1px solid rgb(15, 158, 238); width: 94%;\"></audio> '\n}\n\nvar socketio = io()\nvar mediaStream = null\nsocketio.on('connect', function () {\n  startRecording.disabled = false\n})\nvar startRecording = document.getElementById('start-recording')\nvar stopRecording = document.getElementById('stop-recording')\nvar cameraPreview = document.getElementById('camera-preview')\nvar progressBar = document.querySelector('#progress-bar')\nvar percentage = document.querySelector('#percentage')\nvar recordAudio\nvar recordVideo\nvar sample\nvar liveSample\n\nstartRecording.onclick = function () {\n  startRecording.disabled = true\n\n  if (sample) { sample.disconnect() }\n\n  navigator.getUserMedia({\n    audio: true\n    // video: true\n  }, function (stream) {\n    mediaStream = stream\n\n\n\n    recordAudio = RecordRTC(stream, {\n      type: 'audio',\n      recorderType: StereoAudioRecorder,\n      onAudioProcessStarted: function () {\n        liveSample = configureAudioAPI({type: 'live-audio', source: mediaStream})\n        // recordVideo.startRecording()\n        cameraPreview.src = window.URL.createObjectURL(stream)\n        cameraPreview.play()\n        cameraPreview.muted = true\n        cameraPreview.controls = false\n//                        cameraPreview.context\n      }\n    })\n    // var videoOnlyStream = new MediaStream()\n    // stream.getVideoTracks().forEach(function (track) {\n    //   videoOnlyStream.addTrack(track)\n    // })\n    // recordVideo = RecordRTC(videoOnlyStream, {\n    //   type: 'video',\n    //   recorderType: !!navigator.mozGetUserMedia ? MediaStreamRecorder : WhammyRecorder\n    // })\n    recordAudio.startRecording()\n\n    stopRecording.disabled = false\n  }, function (error) {\n    alert(JSON.stringify(error))\n  })\n}\nstopRecording.onclick = function () {\n  startRecording.disabled = false\n  stopRecording.disabled = true\n  // stop audio recorder\n  // recordAudio.stopRecording(function () {\n  //   // stop video recorder\n  //   recordVideo.stopRecording(function () {\n  //     // get audio data-URL\n  //     recordAudio.getDataURL(function (audioDataURL) {\n  //       // get video data-URL\n  //       recordVideo.getDataURL(function (videoDataURL) {\n  //         var files = {\n  //           audio: {\n  //             type: recordAudio.getBlob().type || 'audio/wav',\n  //             dataURL: audioDataURL\n  //           },\n  //           video: {\n  //             type: recordVideo.getBlob().type || 'video/webm',\n  //             dataURL: videoDataURL\n  //           }\n  //         }\n  //         socketio.emit('message', files)\n  //         if (mediaStream) mediaStream.stop()\n  //       })\n  //     })\n  //     cameraPreview.src = ''\n  //     cameraPreview.poster = 'ajax-loader.gif'\n  //   })\n  // })\n  // if firefox or if you want to record only audio\n  // stop audio recorder\n  recordAudio.stopRecording(function () {\n    // get audio data-URL\n    recordAudio.getDataURL(function (audioDataURL) {\n      var files = {\n        audio: {\n          type: recordAudio.getBlob().type || 'audio/wav',\n          dataURL: audioDataURL\n        }\n      }\n      socketio.emit('message', files)\n      if (mediaStream) mediaStream.stop()\n    })\n    cameraPreview.src = ''\n    cameraPreview.poster = 'ajax-loader.gif'\n  })\n}\n\n$('#rerecord').click(function () {\n  // $('#start-recording').trigger('click')\n  startRecording.click()\n})\nsocketio.on('merged', function (fileName) {\n  var href = (location.href.split('/').pop().length ? location.href.replace(location.href.split('/').pop(), '') : location.href)\n  href = href + 'uploads/' + fileName\n  console.log('got file ' + href)\n  sample = new VisualizerSample(href, function () {\n    sample.togglePlayback()\n// tes\n//     cameraPreview.src = href\n//     cameraPreview.play()\n//     cameraPreview.muted = false\n//     cameraPreview.controls = true\n  })\n})\n\nsocketio.on('ffmpeg-output', function (result) {\n  if (parseInt(result) >= 100) {\n    progressBar.parentNode.style.display = 'none'\n    return\n  }\n  progressBar.parentNode.style.display = 'block'\n  progressBar.value = result\n  percentage.innerHTML = 'Ffmpeg Progress ' + result + '%'\n})\nsocketio.on('ffmpeg-error', function (error) {\n  alert(error)\n})\n"]}