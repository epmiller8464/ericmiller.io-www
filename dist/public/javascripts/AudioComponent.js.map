{"version":3,"sources":["../../../public/javascripts/AudioComponent.js"],"names":["AudioComponent","options","self","_config","_src","_el","el","_recordingKey","recordingKey","_waveformEl","waveformEl","_waveform","waveform","_emitter","EventEmitter","_player","_controls","$play","$pause","$stop","$delete","$status","$duration","_clearAnimationFrame","init","prototype","console","log","howl","src","_","isArray","length","Error","controls","onclick","playClick","pauseClick","stopClick","deleteClick","Howl","once","onLoaded","on","onPlay","onPause","onStop","onError","onEnd","onPlaying","disabled","state","play","textContent","load","pause","stop","destroy","unload","$","ajax","method","url","data","key","done","response","success","innerHTML","message","setTimeout","window","location","href","fail","e","duration","emit","error","arguments","reset","progress","elementId","pos","children","position","left","ci","setInterval","css","pos2","each","a","b","attr","requestAnimationFrame","animateWaveform","buildWaveform","waveForm","element","document","getElementById","h","w","width","p","svg","d3","select","append","style","selectAll","map","i","d","enter","find","text","seek","cancelAnimationFrame","event","handler","off","payload"],"mappings":"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","file":"AudioComponent.js","sourcesContent":["var AudioComponent = function (options) {\n  var self = this\n//            EventEmitter.call(self)\n  self._config = options\n  self._src = []\n  self._el = options.el\n  self._recordingKey = options.recordingKey\n  self._waveformEl = options.waveformEl\n  self._waveform = options.waveform\n  self._emitter = new EventEmitter()\n  self._player = {}\n  self._controls = {\n    $play: null,\n    $pause: null,\n    $stop: null,\n    $delete: null,\n    $status: null,\n    $duration: null\n  }\n  self._clearAnimationFrame = null\n  self.init(options)\n  return self\n}\n\nAudioComponent.prototype = {\n  init: function (options) {\n    var self = this\n    console.log('initialization')\n    if (!options.howl.src || !_.isArray(options.howl.src) || !(_.isArray(options.howl.src) && options.howl.src.length)) {\n      throw new Error('no src files found')\n    }\n    self._controls.$play = options.controls.$play\n    self._controls.$pause = options.controls.$pause\n    self._controls.$stop = options.controls.$stop\n    self._controls.$delete = options.controls.$delete\n    self._controls.$status = options.controls.$status\n    self._controls.$duration = options.controls.$duration\n\n    self._controls.$play.onclick = function () { self.playClick() }\n    self._controls.$pause.onclick = function () { self.pauseClick() }\n    self._controls.$stop.onclick = function () { self.stopClick() }\n    self._controls.$delete.onclick = function () { self.deleteClick() }\n\n    self._player = new Howl(options.howl)\n\n    self._player.once('load', function () { self.onLoaded() })\n    self._player.on('play', function () { self.onPlay() })\n    self._player.on('pause', function () { self.onPause() })\n    self._player.on('stop', function () { self.onStop() })\n    self._player.on('loaderror', function () { self.onError() })\n    self._player.on('end', function () { self.onEnd() })\n\n    self.on('playing', self.onPlaying)\n//                $($(self._el).children('button.pause')[0]).click(self.pause)\n//                $($(self._el).children('button.stop')[0]).click(self.stop)\n    self._controls.$play.disabled = false\n    // $($(self._el).find('.status')[0]).text('listo!')\n  }\n}\n\nAudioComponent.prototype.playClick = function () {\n  var self = this\n  console.log('play click')\n  // console.log('loading')\n  console.log(self._player.state())\n  if (self._player.state() === 'loaded') {\n    self._player.play()\n  } else {\n    self._controls.$status.textContent = 'Loading'\n    self._player.load()\n  }\n}\n\nAudioComponent.prototype.pauseClick = function () {\n  var self = this\n  self._player.pause()\n}\n\nAudioComponent.prototype.stopClick = function () {\n  var self = this\n  self._player.stop()\n  self.destroy()\n}\n\nAudioComponent.prototype.deleteClick = function () {\n  var self = this\n  self._player.stop()\n  self._player.unload()\n  // self.destroy()\n  var recordingKey = self._recordingKey\n  console.log('deleting record: %s', recordingKey)\n  $.ajax({\n    method: 'DELETE',\n    url: '/voice-mail/' + recordingKey,\n    data: {key: recordingKey}\n  })\n  .done(function (response) {\n    if (response.success) {\n      self._controls.$status.innerHTML = response.message + '<br/> <b class=\"text-warning\">The page will reload in a few seconds...</b>'\n      setTimeout(function () { window.location.href = window.location.href }, 3000)\n    } else {\n      console.log(response)\n    }\n  }).fail(function (e) {\n    console.log(e)\n  })\n}\n\nAudioComponent.prototype.onLoaded = function () {\n  var self = this\n  // $($(self._el).find('.duration')[0]).text(self._player.duration() >> 0)\n  // $(self._controls.$duration).text(self._player.duration() >> 0)\n  self._controls.$duration.textContent = self._player.duration() >> 0\n  self._player.play()\n}\n\nAudioComponent.prototype.onPlay = function () {\n  var self = this\n  self._controls.$play.disabled = true\n  self._controls.$pause.disabled = false\n  self._controls.$stop.disabled = false\n  // $($(self._el).find('.status')[0]).text('playing')\n  self._controls.$status.textContent = 'Playing'\n  // $(self._controls.$status).text('playing')\n  self.emit('playing', self)\n}\n\nAudioComponent.prototype.onError = function () {\n  console.error(arguments)\n\n}\n\nAudioComponent.prototype.onPause = function () {\n  var self = this\n  self._controls.$play.disabled = false\n  self._controls.$pause.disabled = true\n  self._controls.$stop.disabled = true\n  self._controls.$status.textContent = 'Paused'\n}\n\nAudioComponent.prototype.onStop = function () {\n  console.log('stopped!')\n  var self = this\n  self._controls.$play.disabled = false\n  self._controls.$pause.disabled = true\n  self._controls.$stop.disabled = true\n  self._controls.$status.textContent = 'Stopped'\n  self.reset()\n  console.log('reset controls')\n}\n\nAudioComponent.prototype.onEnd = function () {\n  console.log('Finished!')\n  var self = this\n  self._controls.$status.textContent = 'Done'\n  self._controls.$duration.textContent = self._player.duration() >> 0\n}\n\nAudioComponent.prototype.progress = function () {\n  var self = this\n  var elementId = self._waveformEl\n  var pos = $($('#' + elementId).children('svg')[0]).data('wave-form-length')\n  var position = $($('#' + elementId).children('svg')[0]).position().left\n  ci = setInterval(function () {\n      $($('#' + elementId).children('svg')[0]).css('left', pos2 + '%')\n      pos2 -= 0.25\n      if ((pos2 % 1) === 0) {\n        pos--\n      }\n      $($('#' + elementId).children('svg')[0]).children('rect')\n      .each(function (a, b) {\n        if ($(b).position().left <= position) {\n          $(b).attr('fill', 'rgba(255,255,255,0.2)')\n        }\n      })\n    }, 250)\n}\n\nAudioComponent.prototype.onPlaying = function (self) {\n  // var self = this\n  console.log('Playing')\n  // self._clearAnimationFrame = setInterval(function () {self.animateWaveform()}, 500)\n  self._clearAnimationFrame = window.requestAnimationFrame(function () {self.animateWaveform()})\n}\n\nAudioComponent.prototype.buildWaveform = function () {\n  var self = this\n  var elementId = self._waveformEl\n  var waveForm = self._waveform\n  var element = document.getElementById(elementId)\n  $('#' + elementId).css(['overflow', 'hidden', 'position', 'relative'])\n  var h = 100, w = $('#' + elementId).width(), p = 2\n\n  var svg = d3.select(element)\n  .append('svg')\n  .attr('width', w)\n  .attr('height', h)\n  .style('moz-transform', 'rotate(180deg)')\n  .style('webkit-transform', 'rotate(180deg)')\n  .style('transform', 'rotate(180deg)')\n  .attr('data-wave-form-length', waveForm.length)\n  .style('position', 'relative')\n  .style('left', '50%')\n  .style('overflow', 'hidden')\n\n  svg.selectAll('rect')\n  .data(waveForm.map(function (i, d) {if (d > 100) {return d - 100} else {return d}}))\n  .enter()\n  .append('rect')\n  .attr('x', function (d, i) {return i * (w / waveForm.length)})\n  .attr('y', 0)\n  .attr('width', (w / waveForm.length - (p)))\n  //            .attr('width', waveForm.length / 100 * 2)\n  .attr('height', function (d) {\n//                console.log(arguments)\n    return ((waveForm[d] / 3))\n  })\n  .attr('fill', 'rgba(33,33,33,0.5)')\n  .attr('data-index', function (d, i) {return i})\n\n}\n\nAudioComponent.prototype.animateWaveform = function () {\n  var self = this\n  $($(self._el).find('.duration')[0]).text((self._player.duration() - (self._player.seek())) >> 0)\n  // console.log(self._player.duration() - (self._player.seek()))\n  self._clearAnimationFrame = window.requestAnimationFrame(function () {self.animateWaveform()})\n}\n\nAudioComponent.prototype.destroy = function () {\n  var self = this\n\n}\n\nAudioComponent.prototype.reset = function () {\n  var self = this\n  // clearInterval(self._clearAnimationFrame)\n  window.cancelAnimationFrame(self._clearAnimationFrame)\n\n}\n\nAudioComponent.prototype.on = function (event, handler) {\n  var self = this\n  return self._emitter.on(event, handler, true)\n\n}\n\nAudioComponent.prototype.off = function (event, handler) {\n  var self = this\n  return self._emitter.off(event, handler, true)\n}\n\nAudioComponent.prototype.emit = function (event, payload) {\n  var self = this\n  return self._emitter.emit(event, payload)\n\n}"]}