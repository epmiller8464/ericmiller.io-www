{"version":3,"sources":["../../../public/javascripts/AudioComponent.js"],"names":["AudioComponent","options","self","_config","_src","_el","el","_audioKey","audioKey","_waveform","waveform","_emitter","EventEmitter","_player","_controls","$play","$pause","$stop","$delete","_clearAnimationFrame","init","prototype","console","log","howl","src","_","isArray","length","Error","controls","onclick","playClick","pauseClick","stopClick","Howl","once","onLoaded","on","onPlay","onPause","onStop","onError","onEnd","onPlaying","disabled","state","play","$","find","text","load","duration","emit","error","arguments","pause","stop","destroy","reset","progress","window","requestAnimationFrame","animateProgress","seek","cancelAnimationFrame","event","handler","off","payload"],"mappings":"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","file":"AudioComponent.js","sourcesContent":["var AudioComponent = function (options) {\n  var self = this\n//            EventEmitter.call(self)\n  self._config = options\n  self._src = []\n  self._el = options.el\n  self._audioKey = options.audioKey\n  self._waveform = options.waveform\n  self._emitter = new EventEmitter()\n  self._player = {}\n  self._controls = {\n    $play: null,\n    $pause: null,\n    $stop: null,\n    $delete: null\n  }\n  self._clearAnimationFrame = null\n  self.init(options)\n  return self\n}\n//        _.assign(AudioComponent, EventEmitter)\nAudioComponent.prototype = {\n  init: function (options) {\n    var self = this\n    console.log('initialization')\n    if (!options.howl.src || !_.isArray(options.howl.src) || !(_.isArray(options.howl.src) && options.howl.src.length)) {\n      throw new Error('no src files found')\n    }\n    self._controls.$play = options.controls.$play\n    self._controls.$pause = options.controls.$pause\n    self._controls.$stop = options.controls.$stop\n    self._controls.$delete = options.controls.$delete\n    self._controls.$play.onclick = function () {self.playClick()}\n    self._controls.$pause.onclick = function () {self.pauseClick()}\n    self._controls.$stop.onclick = function () {self.stopClick()}\n    self._player = new Howl(options.howl)\n\n    self._player.once('load', function () {self.onLoaded()})\n    self._player.on('play', function () {self.onPlay()})\n    self._player.on('pause', function () {self.onPause()})\n    self._player.on('stop', function () {self.onStop()})\n    self._player.on('loaderror', function () {self.onError()})\n    self._player.on('end', function () {self.onEnd()})\n\n    self.on('playing', self.onPlaying)\n//                $($(self._el).children('button.pause')[0]).click(self.pause)\n//                $($(self._el).children('button.stop')[0]).click(self.stop)\n    self._controls.$play.disabled = false\n    // $($(self._el).find('.status')[0]).text('listo!')\n  }\n}\n\nAudioComponent.prototype.playClick = function () {\n  var self = this\n  console.log('play click')\n  // console.log('loading')\n  console.log(self._player.state())\n  if (self._player.state() === 'loaded') {\n    self._player.play()\n  } else {\n    $($(self._el).find('.status')[0]).text('loading...')\n\n    self._player.load()\n  }\n}\n\nAudioComponent.prototype.onLoaded = function () {\n  var self = this\n  $($(self._el).find('.duration')[0]).text(self._player.duration() >> 0)\n\n  self._player.play()\n//            self.emit('playing')\n\n//            self._controls.$play.prop('disabled', false)\n}\nAudioComponent.prototype.onPlay = function () {\n  var self = this\n  self._controls.$play.disabled = true\n  self._controls.$pause.disabled = false\n  self._controls.$stop.disabled = false\n  $($(self._el).find('.status')[0]).text('playing')\n\n  self.emit('playing', self)\n}\n\nAudioComponent.prototype.onError = function () {\n  console.error(arguments)\n\n}\n\nAudioComponent.prototype.pauseClick = function () {\n  var self = this\n  self._player.pause()\n}\nAudioComponent.prototype.onPause = function () {\n  var self = this\n  self._controls.$play.disabled = false\n  self._controls.$pause.disabled = true\n  self._controls.$stop.disabled = true\n  $($(self._el).find('.status')[0]).text('paused')\n\n}\n\nAudioComponent.prototype.stopClick = function () {\n  var self = this\n  self._player.stop()\n  self.destroy()\n}\nAudioComponent.prototype.onStop = function () {\n  console.log('stopped!')\n  var self = this\n  self._controls.$play.disabled = false\n  self._controls.$pause.disabled = true\n  self._controls.$stop.disabled = true\n  $($(self._el).find('.status')[0]).text('stopped')\n  self.reset()\n  console.log('reset controls')\n}\nAudioComponent.prototype.onEnd = function () {\n  console.log('Finished!')\n  $($(self._el).find('.status')[0]).text('done')\n\n}\n\nAudioComponent.prototype.progress = function () {\n  var self = this\n}\n\nAudioComponent.prototype.onPlaying = function (self) {\n  // var self = this\n  console.log('playing')\n  // self._clearAnimationFrame = setInterval(function () {self.animateProgress()}, 500)\n  self._clearAnimationFrame = window.requestAnimationFrame(function () {self.animateProgress()})\n}\n\nAudioComponent.prototype.animateProgress = function () {\n  var self = this\n  $($(self._el).find('.duration')[0]).text((self._player.duration() - (self._player.seek())) >> 0)\n  // console.log(self._player.duration() - (self._player.seek()))\n  self._clearAnimationFrame = window.requestAnimationFrame(function () {self.animateProgress()})\n}\n\nAudioComponent.prototype.destroy = function () {\n  var self = this\n\n}\nAudioComponent.prototype.reset = function () {\n  var self = this\n  // clearInterval(self._clearAnimationFrame)\n  window.cancelAnimationFrame(self._clearAnimationFrame)\n\n}\n\nAudioComponent.prototype.on = function (event, handler) {\n  var self = this\n  return self._emitter.on(event, handler, true)\n\n}\n\nAudioComponent.prototype.off = function (event, handler) {\n  var self = this\n  return self._emitter.off(event, handler, true)\n}\nAudioComponent.prototype.emit = function (event, payload) {\n  var self = this\n  return self._emitter.emit(event, payload)\n\n}"]}