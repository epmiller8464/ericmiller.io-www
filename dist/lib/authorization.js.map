{"version":3,"sources":["../../lib/authorization.js"],"names":["config","require","AWS","ep","Endpoint","s3","S3","apiVersion","endpoint","createSignedUrl","key","signedUrlExpireSeconds","url","getSignedUrl","Bucket","audio_bucket","Key","Expires","module","exports"],"mappings":"AAAA;AACA;;AACA,IAAIA,SAASC,QAAQ,WAAR,CAAb;AACA,IAAMC,MAAMD,QAAQ,SAAR,CAAZ;AACA,IAAME,KAAK,IAAID,IAAIE,QAAR,CAAiB,4BAAjB,CAAX;AACA,IAAMC,KAAK,IAAIH,IAAII,EAAR,CAAW,EAACC,YAAY,YAAb,EAA2BC,UAAUL,EAArC,EAAX,CAAX;;AAEA;;AAEA,SAASM,eAAT,CAA0BC,GAA1B,EAA+B;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA,MAAMC,yBAAyB,QAAQ,CAAvC;;AAEA,MAAMC,MAAMP,GAAGQ,YAAH,CAAgB,WAAhB,EAA6B;AACvC;AACAC,YAAQd,OAAOe,YAFwB,EAEX;AAC5BC,SAAKN,GAHkC;AAIvCO,aAASN;AAJ8B,GAA7B,CAAZ;;AAOA,SAAOC,GAAP;AACD;;AAEDM,OAAOC,OAAP,GAAiB,EAACV,gCAAD,EAAjB","file":"authorization.js","sourcesContent":["'use strict'\n// require('dotenv').config()\nlet config = require('../config')\nconst AWS = require('aws-sdk')\nconst ep = new AWS.Endpoint('s3-us-west-1.amazonaws.com')\nconst s3 = new AWS.S3({apiVersion: '2006-03-01', endpoint: ep})\n\n// const s3 = new AWS.S3({apiVersion: '2006-03-01'})\n\nfunction createSignedUrl (key) {\n  // let s3 = new AWS.S3({apiVersion: '2006-03-01'})\n  // AWS.config.update({\n  //   accessKeyId: process.env.AWS_ACCESS_KEY_ID,\n  //   secretAccessKey: process.env.AWS_SECRET_ACCESS_KEY\n  // })\n  // s3.service.endpoint.hostname == 'awsproxy.example.com'\n  const signedUrlExpireSeconds = 86400 * 7\n\n  const url = s3.getSignedUrl('getObject', {\n    // Bucket: process.env.AWS_AUDIO_BUCKET,// + '/voice-messages',\n    Bucket: config.audio_bucket,// + '/voice-messages',\n    Key: key,\n    Expires: signedUrlExpireSeconds\n  })\n\n  return url\n}\n\nmodule.exports = {createSignedUrl}"]}